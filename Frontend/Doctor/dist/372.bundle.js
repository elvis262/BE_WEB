"use strict";(self.webpackChunkdoctor=self.webpackChunkdoctor||[]).push([[372,146],{372:(e,t,o)=>{o.r(t),o.d(t,{add:()=>a,save:()=>u});var n=o(146);const r=document.querySelector("#addModal"),s=(e,t)=>{const[o,n]=e.split(" "),[r,s,l]=o.split("/"),[i,c,u]=n.split(":"),a=new Date(l,s-1,r,i,c,u);return a.setHours(a.getHours()+t),a.toLocaleString("fr-FR")};function l(e,t=!1){const o=document.querySelector("#consulationTemplate"),l=document.querySelector("#mainContainer"),i=document.importNode(o.content,!0);if(i.querySelector("#savedPhoto").style.backgroundImage=`url(${e.student.photo})`,i.querySelector("#name").innerText=e.student.name.length>15?e.student.name.slice(0,12)+"..":e.student.name,i.querySelector("#school").innerText=e.student.school.libelle,i.querySelector("#class").innerText=e.student.class.libelle,i.querySelector("#matricule").innerText=e.student.registration,i.querySelector("#restStart").innerText=e.date,i.querySelector("#restEnd").innerText=e.restDuration,i.querySelector("#date").innerText=s(e.date.toLocaleString("fr-FR"),e.restDuration),i.querySelector("#seeMore").addEventListener("click",(t=>{let o=document.importNode(r.content,!0);o=Array.from(o.children),o[0].addEventListener("click",(e=>{e.stopPropagation()})),o[0].querySelector("#profilePhoto").style.backgroundImage=`url(${e.student.photo})`,o[0].querySelector("#profileName").innerText=e.student.name,o[0].querySelector("#profileSchool").innerText=e.student.school.libelle,o[0].querySelector("#profileClass").innerText=e.student.class.libelle;const s=o[0].querySelector("#rest > input");s.checked=0!==e.restDuration,s.style.pointerEvents="none",o[0].querySelector("#save").style.display="none";const l=o[0].querySelector(".number");l.classList.add("visible"),l.style.pointerEvents="none",l.querySelector("input").value=e.restDuration,(0,n.showDivWithOpacityAnimation)(o[0],!0,e.diagnostic)})),!1===t){const t=JSON.parse(sessionStorage.getItem("consultations")),o=0!==t.length?[...t,e]:[i];sessionStorage.setItem("consultations",JSON.stringify(o))}l.prepend(i)}var i=o(901),c=o.n(i);async function u(e){const t=new Date,o={student:{name:"",registration:"",photo:"",class:{libelle:""},school:{libelle:""}},diagnostic:JSON.stringify([]),restDuration:0,date:t.toLocaleString("fr-FR")},r=document.querySelector("#nothing"),s=sessionStorage.getItem("studentId");o.student.name=document.querySelector("#student").value,o.student.school.libelle=document.querySelector("#school-st").value,o.student.registration=document.querySelector("#matricule-st").value,o.student.class.libelle=document.querySelector("#classe-st").value,o.student.photo=document.querySelector("#photo-st").style.backgroundImage.split("url(")[1].split(")")[0],console.log("étape 1",e);const i=document.querySelector(".number > input").value,u=Array.from(document.querySelector(".ql-editor").children).map((e=>e.innerHTML));o.diagnostic=JSON.stringify(u),o.restDuration=parseInt(i),console.log("étape 2"),e.emit("newConsultation",{studentId:s,restDuration:parseInt(i),diagnostic:JSON.stringify(u),studentClass:o.student.class.libelle,studentRegistration:o.student.registration}),e.on("addSucced",(t=>{console.log("first",e),t?(r.classList.contains("visible")&&r.classList.remove("visible"),l(o),document.querySelector("#photo-st").style.backgroundImage="",document.querySelector("#student").value="",document.querySelector("#matricule-st").value="",document.querySelector("#classe-st").value="",document.querySelector("#school-st").value="",document.querySelector("#no-student").classList.add("visible"),document.querySelector("#add").classList.remove("visible"),document.querySelector("#reset").classList.remove("visible"),document.querySelector("#searchStudent").value="",(0,n.hideDivWithOpacityAnimation)()):(c().options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-full-width",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},c().error("Une erreur s'est produite"),(0,n.hideDivWithOpacityAnimation)())}))}function a(e){l(e,!0)}},146:(e,t,o)=>{o.r(t),o.d(t,{hideDivWithOpacityAnimation:()=>c,showDivWithOpacityAnimation:()=>i});var n=o(95),r=o.n(n),s=(o(295),[["bold","italic"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],[{align:[]}],["clean"]]);const l=document.querySelector("#modal");function i(e,t=!1,o=JSON.stringify([])){o=JSON.parse(o),l.style.display="block",requestAnimationFrame((function(){if(l.style.opacity="1",l.appendChild(e),null===e.querySelector(".ql-toolbar.ql-snow")&&e.querySelector("#editor")&&(editor=function(e=!1){var t={modules:{toolbar:s},placeholder:"Diagnostique........",readOnly:e,theme:"snow"};return new(r())("#editor",t)}(t)),0!==o.length){const e=document.querySelector(".ql-editor");e.setAttribute("data-placeholder","Diagnostique :"),o.forEach((t=>{const o=document.createElement("p");o.innerHTML=t,e.appendChild(o)}))}try{e.style.opacity="1",e.style.pointerEvents="auto"}catch(e){console.log(e)}}))}function c(){const e=Array.from(l.children)[0];console.log(e),setTimeout((function(){e.style.opacity="0"}),30),setTimeout((()=>{e.remove(),l.style.opacity="0"}),60),setTimeout((()=>{l.style.display="none"}),110)}}}]);